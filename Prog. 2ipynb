{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OkcyIzSFEDWA","outputId":"70e7a7e6-5d06-4e3b-b1ba-b46aeb09273e","executionInfo":{"status":"ok","timestamp":1719151318529,"user_tz":-120,"elapsed":15879,"user":{"displayName":"Tania Brusadin","userId":"18197826850071657743"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.31.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.7)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2024.6.2)\n"]}],"source":["pip install requests"]},{"cell_type":"markdown","metadata":{"id":"OsaFifD_GzYj"},"source":["1. Importo i pacchetti necessari"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ycSGOMwiCvsa"},"outputs":[],"source":["import csv\n","import pandas as pd\n","import json"]},{"cell_type":"markdown","metadata":{"id":"unxIWAMKG32L"},"source":["2. Creo il file csv"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hKvCNP4cALyC","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1719151319002,"user_tz":-120,"elapsed":32,"user":{"displayName":"Tania Brusadin","userId":"18197826850071657743"}},"outputId":"79dc06e7-8a6c-4ab9-df34-026546a28dd9"},"outputs":[{"output_type":"stream","name":"stdout","text":["File prog_2.csv creato con successo.\n","  codice_IPA                     nome_ente              comune  \\\n","0     c_g875      Comune_di_Ponzano_Veneto      Ponzano_Veneto   \n","1     c_c123       Comune_di_Castelguidone       Castelguidone   \n","2     c_l474            Comune_di_Turriaco            Turriaco   \n","3     c_h017           Comune_di_Predappio           Predappio   \n","4     c_l474            Comune_di_Turriaco            Turriaco   \n","5     c_l503                 Comune_di_Uri                 Uri   \n","6     c_c167  Comune_di_Castelletto_Uzzone  Castelletto_Uzzone   \n","7     c_f205              Comune_di_Milano              Milano   \n","8     c_d903          Comune_di_Gandellino          Gandellino   \n","\n","  codice_ISTAT_comune importo_finanziamento codice_ID_finanziamento  \\\n","0              026059                5142.0                    1111   \n","1              069019                3642.0                    2222   \n","2              031024               10172.0                    3333   \n","3              040032               14000.0                    4444   \n","4              031024               77897.0                    5555   \n","5              090076               17603.0                    6666   \n","6              004050               12747.0                    7777   \n","7              015146               97247.0                    8888   \n","8              016107               79922.0                    9999   \n","\n","                                         avviso_PNRR codice_ID_avviso_PNRR  \n","0                    1.4.3_pagoPA_Comuni_maggio_2023                 1.4.3  \n","1                    1.4.3_pagoPA_Comuni_maggio_2023                 1.4.3  \n","2  1.3.1_Piattaforma_Digitale_Nazionale_Dati_Comu...                 1.3.1  \n","3      1.4.4_Adozione_SPID_CIE_Comuni_settembre_2022                 1.4.4  \n","4       1.2_Abilitazione_al_Cloud_Comuni_luglio_2022                   1.2  \n","5                 1.4.3_pagoPA_Comuni_settembre_2022                 1.4.3  \n","6                    1.4.3_pagoPA_Comuni_maggio_2023                 1.4.3  \n","7  1.4.5_Piattaforma_Notifiche_Digitali_Comuni_se...                 1.4.5  \n","8  1.4.1_Esperienza_del_Cittadino_Comuni_settembr...                 1.4.1  \n"]}],"source":["# Dati da scrivere nel file CSV\n","dati = [\n","    [\"codice_IPA\", \"nome_ente\", \"comune\", \"codice_ISTAT_comune\", \"importo_finanziamento\", \"codice_ID_finanziamento\", \"avviso_PNRR\", \"codice_ID_avviso_PNRR\"],\n","    [\"c_g875\", \"Comune_di_Ponzano_Veneto\", \"Ponzano_Veneto\", \"026059\", 5142.0, \"1111\", \"1.4.3_pagoPA_Comuni_maggio_2023\", \"1.4.3\"],\n","    [\"c_c123\", \"Comune_di_Castelguidone\", \"Castelguidone\", \"069019\", 3642.0, \"2222\", \"1.4.3_pagoPA_Comuni_maggio_2023\", \"1.4.3\"],\n","    [\"c_l474\", \"Comune_di_Turriaco\", \"Turriaco\", \"031024\", 10172.0, \"3333\", \"1.3.1_Piattaforma_Digitale_Nazionale_Dati_Comuni_ottobre_2022\", \"1.3.1\"],\n","    [\"c_h017\", \"Comune_di_Predappio\", \"Predappio\", \"040032\", 14000.0, \"4444\", \"1.4.4_Adozione_SPID_CIE_Comuni_settembre_2022\", \"1.4.4\"],\n","    [\"c_l474\", \"Comune_di_Turriaco\", \"Turriaco\", \"031024\", 77897.0, \"5555\", \"1.2_Abilitazione_al_Cloud_Comuni_luglio_2022\", \"1.2\"],\n","    [\"c_l503\", \"Comune_di_Uri\", \"Uri\", \"090076\", 17603.0, \"6666\", \"1.4.3_pagoPA_Comuni_settembre_2022\", \"1.4.3\"],\n","    [\"c_c167\", \"Comune_di_Castelletto_Uzzone\", \"Castelletto_Uzzone\", \"004050\", 12747.0, \"7777\", \"1.4.3_pagoPA_Comuni_maggio_2023\", \"1.4.3\"],\n","    [\"c_f205\", \"Comune_di_Milano\", \"Milano\", \"015146\", 97247.0, \"8888\", \"1.4.5_Piattaforma_Notifiche_Digitali_Comuni_settembre_2022\", \"1.4.5\"],\n","    [\"c_d903\", \"Comune_di_Gandellino\", \"Gandellino\", \"016107\", 79922.0, \"9999\", \"1.4.1_Esperienza_del_Cittadino_Comuni_settembre_2022\", \"1.4.1\"]\n","]\n","\n","# Nome del file CSV\n","Prog_2_csv = \"prog_2.csv\"\n","\n","# Scrittura dei dati nel file CSV\n","with open(Prog_2_csv, mode='w', newline='') as file:\n","    scrittore_csv = csv.writer(file)\n","    scrittore_csv.writerows(dati)\n","\n","print(f\"File {Prog_2_csv} creato con successo.\")\n","\n","# Lettura del file CSV e visualizzazione in formato tabellare\n","file_csv = pd.read_csv(Prog_2_csv, dtype=str)\n","print (file_csv)"]},{"cell_type":"markdown","metadata":{"id":"sG1rhPGnHHY4"},"source":["3. Creo il file .json"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qIq96Zz0HE3y","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1719151319004,"user_tz":-120,"elapsed":28,"user":{"displayName":"Tania Brusadin","userId":"18197826850071657743"}},"outputId":"9d6a49bb-24c7-4ad7-ae5d-fc023a13a02f"},"outputs":[{"output_type":"stream","name":"stdout","text":["File prog_2.json creato con successo.\n","[\n","    {\n","        \"codice_IPA\": \"c_g875\",\n","        \"nome_ente\": \"Comune_di_Ponzano_Veneto\",\n","        \"comune\": \"Ponzano_Veneto\",\n","        \"codice_ISTAT_comune\": \"026059\",\n","        \"importo_finanziamento\": \"5142.0\",\n","        \"codice_ID_finanziamento\": \"1111\",\n","        \"avviso_PNRR\": \"1.4.3_pagoPA_Comuni_maggio_2023\",\n","        \"codice_ID_avviso_PNRR\": \"1.4.3\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_c123\",\n","        \"nome_ente\": \"Comune_di_Castelguidone\",\n","        \"comune\": \"Castelguidone\",\n","        \"codice_ISTAT_comune\": \"069019\",\n","        \"importo_finanziamento\": \"3642.0\",\n","        \"codice_ID_finanziamento\": \"2222\",\n","        \"avviso_PNRR\": \"1.4.3_pagoPA_Comuni_maggio_2023\",\n","        \"codice_ID_avviso_PNRR\": \"1.4.3\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_l474\",\n","        \"nome_ente\": \"Comune_di_Turriaco\",\n","        \"comune\": \"Turriaco\",\n","        \"codice_ISTAT_comune\": \"031024\",\n","        \"importo_finanziamento\": \"10172.0\",\n","        \"codice_ID_finanziamento\": \"3333\",\n","        \"avviso_PNRR\": \"1.3.1_Piattaforma_Digitale_Nazionale_Dati_Comuni_ottobre_2022\",\n","        \"codice_ID_avviso_PNRR\": \"1.3.1\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_h017\",\n","        \"nome_ente\": \"Comune_di_Predappio\",\n","        \"comune\": \"Predappio\",\n","        \"codice_ISTAT_comune\": \"040032\",\n","        \"importo_finanziamento\": \"14000.0\",\n","        \"codice_ID_finanziamento\": \"4444\",\n","        \"avviso_PNRR\": \"1.4.4_Adozione_SPID_CIE_Comuni_settembre_2022\",\n","        \"codice_ID_avviso_PNRR\": \"1.4.4\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_l474\",\n","        \"nome_ente\": \"Comune_di_Turriaco\",\n","        \"comune\": \"Turriaco\",\n","        \"codice_ISTAT_comune\": \"031024\",\n","        \"importo_finanziamento\": \"77897.0\",\n","        \"codice_ID_finanziamento\": \"5555\",\n","        \"avviso_PNRR\": \"1.2_Abilitazione_al_Cloud_Comuni_luglio_2022\",\n","        \"codice_ID_avviso_PNRR\": \"1.2\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_l503\",\n","        \"nome_ente\": \"Comune_di_Uri\",\n","        \"comune\": \"Uri\",\n","        \"codice_ISTAT_comune\": \"090076\",\n","        \"importo_finanziamento\": \"17603.0\",\n","        \"codice_ID_finanziamento\": \"6666\",\n","        \"avviso_PNRR\": \"1.4.3_pagoPA_Comuni_settembre_2022\",\n","        \"codice_ID_avviso_PNRR\": \"1.4.3\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_c167\",\n","        \"nome_ente\": \"Comune_di_Castelletto_Uzzone\",\n","        \"comune\": \"Castelletto_Uzzone\",\n","        \"codice_ISTAT_comune\": \"004050\",\n","        \"importo_finanziamento\": \"12747.0\",\n","        \"codice_ID_finanziamento\": \"7777\",\n","        \"avviso_PNRR\": \"1.4.3_pagoPA_Comuni_maggio_2023\",\n","        \"codice_ID_avviso_PNRR\": \"1.4.3\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_f205\",\n","        \"nome_ente\": \"Comune_di_Milano\",\n","        \"comune\": \"Milano\",\n","        \"codice_ISTAT_comune\": \"015146\",\n","        \"importo_finanziamento\": \"97247.0\",\n","        \"codice_ID_finanziamento\": \"8888\",\n","        \"avviso_PNRR\": \"1.4.5_Piattaforma_Notifiche_Digitali_Comuni_settembre_2022\",\n","        \"codice_ID_avviso_PNRR\": \"1.4.5\"\n","    },\n","    {\n","        \"codice_IPA\": \"c_d903\",\n","        \"nome_ente\": \"Comune_di_Gandellino\",\n","        \"comune\": \"Gandellino\",\n","        \"codice_ISTAT_comune\": \"016107\",\n","        \"importo_finanziamento\": \"79922.0\",\n","        \"codice_ID_finanziamento\": \"9999\",\n","        \"avviso_PNRR\": \"1.4.1_Esperienza_del_Cittadino_Comuni_settembre_2022\",\n","        \"codice_ID_avviso_PNRR\": \"1.4.1\"\n","    }\n","]\n"]}],"source":["# Nome del file JSON\n","Prog_2_json = \"prog_2.json\"\n","\n","# Conversione del DataFrame in un dizionario e scrittura nel file JSON\n","file_csv.to_json(Prog_2_json, orient='records', indent=4)\n","\n","print(f\"File {Prog_2_json} creato con successo.\")\n","\n","# Lettura e stampa del contenuto del file JSON\n","with open(Prog_2_json, 'r') as file:\n","    contenuto_json = json.load(file)\n","    print(json.dumps(contenuto_json, indent=4))"]},{"cell_type":"code","source":["!pip install rdflib"],"metadata":{"id":"j3P79a1Ps-lp","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1719151331343,"user_tz":-120,"elapsed":12354,"user":{"displayName":"Tania Brusadin","userId":"18197826850071657743"}},"outputId":"4d943cfb-cc32-4d58-96a4-b1409e61ddb0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting rdflib\n","  Downloading rdflib-7.0.0-py3-none-any.whl (531 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m531.9/531.9 kB\u001b[0m \u001b[31m6.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting isodate<0.7.0,>=0.6.0 (from rdflib)\n","  Downloading isodate-0.6.1-py2.py3-none-any.whl (41 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m41.7/41.7 kB\u001b[0m \u001b[31m3.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pyparsing<4,>=2.1.0 in /usr/local/lib/python3.10/dist-packages (from rdflib) (3.1.2)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from isodate<0.7.0,>=0.6.0->rdflib) (1.16.0)\n","Installing collected packages: isodate, rdflib\n","Successfully installed isodate-0.6.1 rdflib-7.0.0\n"]}]},{"cell_type":"code","source":["from rdflib import Graph, Namespace, URIRef, Literal\n","from rdflib.namespace import RDF, RDFS, XSD\n","\n","# Definizione dei namespace RDF\n","L0 = Namespace(\"https://w3id.org/italia/onto/l0/\")\n","COV = Namespace(\"https://w3id.org/italia/onto/COV/\")\n","CLV = Namespace(\"https://w3id.org/italia/onto/CLV/\")\n","PRJ = Namespace(\"https://w3id.org/italia/onto/PRJ/\")\n","\n","# Creazione del grafo RDFLib\n","g = Graph()\n","\n","# Bind dei namespace\n","g.bind(\"l0\", L0)\n","g.bind(\"cov\", COV)\n","g.bind(\"clv\", CLV)\n","g.bind(\"prj\", PRJ)\n","g.bind(\"rdfs\", RDFS)\n","g.bind(\"xsd\", XSD)\n","\n","# Funzione per aggiungere triple RDF dal CSV al grafo RDFLib\n","def add_csv_data_to_graph(filename):\n","    with open(filename, newline='', encoding='utf-8') as csvfile:\n","        reader = csv.reader(csvfile)\n","        next(reader)  # Salta l'intestazione\n","        # Lista per memorizzare i progetti in ordine di codice ID finanziamento\n","        projects = []\n","        for row in reader:\n","            codice_IPA = row[0]\n","            nome_ente = row[1]\n","            comune = row[2]\n","            codice_ISTAT_comune = row[3]\n","            importo_finanziamento = float(row[4])\n","            codice_ID_finanziamento = row[5]\n","            avviso_PNRR = row[6]\n","            codice_ID_avviso_PNRR = row[7]\n","\n","            # URI delle risorse RDF\n","            public_org_uri = URIRef(f\"https://esame.MITD.it/data/PublicOrganization/{codice_IPA}\")\n","            city_uri = URIRef(f\"https://esame.MITD.it/data/City/{codice_ISTAT_comune}\")\n","            project_uri = URIRef(f\"https://esame.MITD.it/data/PublicInvestmentProject/{codice_ID_finanziamento}\")\n","            call_uri = URIRef(f\"https://esame.MITD.it/data/Call/{codice_ID_avviso_PNRR}\")\n","\n","            # Aggiunta delle triple al grafo RDFLib\n","            g.add((public_org_uri, RDF.type, COV.PublicOrganization))\n","            g.add((public_org_uri, COV.IPACode, Literal(codice_IPA)))\n","            g.add((public_org_uri, COV.legalName, Literal(nome_ente)))\n","            g.add((public_org_uri, CLV.hasSpatialCoverage, city_uri))\n","            g.add((public_org_uri, PRJ.isInvolvedInProject, project_uri))\n","\n","            g.add((city_uri, RDF.type, CLV.City))\n","            g.add((city_uri, L0.name, Literal(comune)))\n","            g.add((city_uri, L0.identifier, Literal(codice_ISTAT_comune)))\n","\n","            g.add((project_uri, RDF.type, PRJ.PublicInvestmentProject))\n","            g.add((project_uri, PRJ.projectTotalCost, Literal(importo_finanziamento, datatype=XSD.float)))\n","            g.add((project_uri, PRJ.hasCall, call_uri))\n","\n","            g.add((call_uri, RDF.type, PRJ.Call))\n","            g.add((call_uri, L0.name, Literal(avviso_PNRR)))\n","\n","            # Memorizza il progetto in ordine di codice ID finanziamento\n","            projects.append((codice_ID_finanziamento, project_uri))\n","\n","        # Ordina i progetti in base al codice ID finanziamento\n","        projects.sort(key=lambda x: x[0])\n","\n","        # Aggiungi i progetti al grafo RDFLib nell'ordine corretto\n","        for _, project_uri in projects:\n","            g.add((project_uri, RDF.type, PRJ.PublicInvestmentProject))\n","\n","# Chiamata alla funzione per aggiungere dati dal CSV al grafo\n","csv_filename = \"prog_2.csv\"\n","add_csv_data_to_graph(csv_filename)\n","\n","# Serializzazione del grafo in Turtle\n","turtle_file = \"ontology.ttl\"\n","g.serialize(destination=turtle_file, format=\"turtle\")\n","\n","# Serializzazione del grafo in RDF/XML\n","rdf_file = \"ontology.rdf\"\n","g.serialize(destination=rdf_file, format=\"xml\")\n","\n","# Stampare il contenuto del file Turtle\n","with open(turtle_file, \"r\") as file:\n","    turtle_content = file.read()\n","\n","print(\"Turtle format:\\n\")\n","print(turtle_content)\n","\n","# Stampare il contenuto del file RDF/XML\n","with open(rdf_file, \"r\") as file:\n","    rdf_content = file.read()\n"],"metadata":{"id":"vR13nLZpN6OQ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1719151331344,"user_tz":-120,"elapsed":55,"user":{"displayName":"Tania Brusadin","userId":"18197826850071657743"}},"outputId":"c3d2c796-224a-48aa-9db6-e35e9bde9c9b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Turtle format:\n","\n","@prefix clv: <https://w3id.org/italia/onto/CLV/> .\n","@prefix cov: <https://w3id.org/italia/onto/COV/> .\n","@prefix l0: <https://w3id.org/italia/onto/l0/> .\n","@prefix prj: <https://w3id.org/italia/onto/PRJ/> .\n","@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_c123> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/069019> ;\n","    cov:IPACode \"c_c123\" ;\n","    cov:legalName \"Comune_di_Castelguidone\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/2222> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_c167> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/004050> ;\n","    cov:IPACode \"c_c167\" ;\n","    cov:legalName \"Comune_di_Castelletto_Uzzone\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/7777> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_d903> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/016107> ;\n","    cov:IPACode \"c_d903\" ;\n","    cov:legalName \"Comune_di_Gandellino\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/9999> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_f205> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/015146> ;\n","    cov:IPACode \"c_f205\" ;\n","    cov:legalName \"Comune_di_Milano\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/8888> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_g875> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/026059> ;\n","    cov:IPACode \"c_g875\" ;\n","    cov:legalName \"Comune_di_Ponzano_Veneto\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/1111> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_h017> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/040032> ;\n","    cov:IPACode \"c_h017\" ;\n","    cov:legalName \"Comune_di_Predappio\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/4444> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_l474> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/031024> ;\n","    cov:IPACode \"c_l474\" ;\n","    cov:legalName \"Comune_di_Turriaco\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/3333>,\n","        <https://esame.MITD.it/data/PublicInvestmentProject/5555> .\n","\n","<https://esame.MITD.it/data/PublicOrganization/c_l503> a cov:PublicOrganization ;\n","    clv:hasSpatialCoverage <https://esame.MITD.it/data/City/090076> ;\n","    cov:IPACode \"c_l503\" ;\n","    cov:legalName \"Comune_di_Uri\" ;\n","    prj:isInvolvedInProject <https://esame.MITD.it/data/PublicInvestmentProject/6666> .\n","\n","<https://esame.MITD.it/data/Call/1.2> a prj:Call ;\n","    l0:name \"1.2_Abilitazione_al_Cloud_Comuni_luglio_2022\" .\n","\n","<https://esame.MITD.it/data/Call/1.3.1> a prj:Call ;\n","    l0:name \"1.3.1_Piattaforma_Digitale_Nazionale_Dati_Comuni_ottobre_2022\" .\n","\n","<https://esame.MITD.it/data/Call/1.4.1> a prj:Call ;\n","    l0:name \"1.4.1_Esperienza_del_Cittadino_Comuni_settembre_2022\" .\n","\n","<https://esame.MITD.it/data/Call/1.4.4> a prj:Call ;\n","    l0:name \"1.4.4_Adozione_SPID_CIE_Comuni_settembre_2022\" .\n","\n","<https://esame.MITD.it/data/Call/1.4.5> a prj:Call ;\n","    l0:name \"1.4.5_Piattaforma_Notifiche_Digitali_Comuni_settembre_2022\" .\n","\n","<https://esame.MITD.it/data/City/004050> a clv:City ;\n","    l0:identifier \"004050\" ;\n","    l0:name \"Castelletto_Uzzone\" .\n","\n","<https://esame.MITD.it/data/City/015146> a clv:City ;\n","    l0:identifier \"015146\" ;\n","    l0:name \"Milano\" .\n","\n","<https://esame.MITD.it/data/City/016107> a clv:City ;\n","    l0:identifier \"016107\" ;\n","    l0:name \"Gandellino\" .\n","\n","<https://esame.MITD.it/data/City/026059> a clv:City ;\n","    l0:identifier \"026059\" ;\n","    l0:name \"Ponzano_Veneto\" .\n","\n","<https://esame.MITD.it/data/City/031024> a clv:City ;\n","    l0:identifier \"031024\" ;\n","    l0:name \"Turriaco\" .\n","\n","<https://esame.MITD.it/data/City/040032> a clv:City ;\n","    l0:identifier \"040032\" ;\n","    l0:name \"Predappio\" .\n","\n","<https://esame.MITD.it/data/City/069019> a clv:City ;\n","    l0:identifier \"069019\" ;\n","    l0:name \"Castelguidone\" .\n","\n","<https://esame.MITD.it/data/City/090076> a clv:City ;\n","    l0:identifier \"090076\" ;\n","    l0:name \"Uri\" .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/1111> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.4.3> ;\n","    prj:projectTotalCost \"5142.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/2222> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.4.3> ;\n","    prj:projectTotalCost \"3642.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/3333> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.3.1> ;\n","    prj:projectTotalCost \"10172.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/4444> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.4.4> ;\n","    prj:projectTotalCost \"14000.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/5555> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.2> ;\n","    prj:projectTotalCost \"77897.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/6666> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.4.3> ;\n","    prj:projectTotalCost \"17603.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/7777> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.4.3> ;\n","    prj:projectTotalCost \"12747.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/8888> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.4.5> ;\n","    prj:projectTotalCost \"97247.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/PublicInvestmentProject/9999> a prj:PublicInvestmentProject ;\n","    prj:hasCall <https://esame.MITD.it/data/Call/1.4.1> ;\n","    prj:projectTotalCost \"79922.0\"^^xsd:float .\n","\n","<https://esame.MITD.it/data/Call/1.4.3> a prj:Call ;\n","    l0:name \"1.4.3_pagoPA_Comuni_maggio_2023\",\n","        \"1.4.3_pagoPA_Comuni_settembre_2022\" .\n","\n","\n"]}]},{"cell_type":"code","source":["from rdflib import Graph, Namespace, Literal\n","from rdflib.namespace import RDF, RDFS, XSD\n","import csv\n","\n","# Definizione dei namespace RDF\n","L0 = Namespace(\"https://w3id.org/italia/onto/l0/\")\n","COV = Namespace(\"https://w3id.org/italia/onto/COV/\")\n","CLV = Namespace(\"https://w3id.org/italia/onto/CLV/\")\n","PRJ = Namespace(\"https://w3id.org/italia/onto/PRJ/\")\n","\n","# Creazione del grafo RDFLib\n","g = Graph()\n","\n","# Bind dei namespace\n","g.bind(\"l0\", L0)\n","g.bind(\"cov\", COV)\n","g.bind(\"clv\", CLV)\n","g.bind(\"prj\", PRJ)\n","\n","# Caricamento del grafo RDF da un file Turtle\n","turtle_file = \"ontology.ttl\"\n","g.parse(turtle_file, format=\"turtle\")\n","\n","# Funzione per estrarre le triple RDF di una specifica entità\n","def extract_entity_properties(entity_type):\n","    entity_properties = []\n","    for s, p, o in g.triples((None, RDF.type, entity_type)):\n","        properties = [(str(p).split(\"/\")[-1], str(o)) for p, o in g.predicate_objects(s)]\n","        entity_properties.append(properties)\n","    return entity_properties\n","\n","# Generazione del modello YARRRML\n","mapping_yarrrml = \"\"\"\n","prefixes:\n","  l0: \"https://w3id.org/italia/onto/l0/\"\n","  cov: \"https://w3id.org/italia/onto/COV/\"\n","  clv: \"https://w3id.org/italia/onto/CLV/\"\n","  prj: \"https://w3id.org/italia/onto/PRJ/\"\n","\n","mappings:\n","  PublicOrganization:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/PublicOrganization/$(codice_IPA)\n","    po:\n","      - [a, cov:PublicOrganization]\n","      - [cov:IPACode, $(codice_IPA)]\n","      - [cov:legalName, $(nome_ente)]\n","      - [clv:hasSpatialCoverage, https://esame.MITD.it/data/City/$(codice_ISTAT_comune)~iri]\n","      - [prj:isInvolvedInProject, https://esame.MITD.it/data/PublicInvestmentProject/$(codice_finanziamento)~iri]\n","\n","  City:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/City/$(codice_ISTAT_comune)\n","    po:\n","      - [a, clv:City]\n","      - [l0:name, $(comune)]\n","      - [l0:identifier, $(codice_ISTAT_comune)]\n","\n","  PublicInvestmentProject:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/PublicInvestmentProject/$(codice_finanziamento)\n","    po:\n","      - [a, prj:PublicInvestmentProject]\n","      - [prj:projectTotalCost, $(importo_finanziamento)]\n","      - [prj:hasCall, https://esame.MITD.it/data/Call/$(codice_avviso_PNRR)~iri]\n","\n","  Call:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/Call/$(codice_avviso_PNRR)\n","    po:\n","      - [a, prj:Call]\n","      - [l0:name, $(avviso_PNRR)]\n","\"\"\"\n","\n","print(mapping_yarrrml)\n"],"metadata":{"id":"eF2jJ6sYQIU8","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1719151331345,"user_tz":-120,"elapsed":35,"user":{"displayName":"Tania Brusadin","userId":"18197826850071657743"}},"outputId":"0998bc5b-ca14-43a0-fe82-f3077cf78b00"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","prefixes:\n","  l0: \"https://w3id.org/italia/onto/l0/\"\n","  cov: \"https://w3id.org/italia/onto/COV/\"\n","  clv: \"https://w3id.org/italia/onto/CLV/\"\n","  prj: \"https://w3id.org/italia/onto/PRJ/\"\n","\n","mappings:\n","  PublicOrganization:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/PublicOrganization/$(codice_IPA)\n","    po:\n","      - [a, cov:PublicOrganization]\n","      - [cov:IPACode, $(codice_IPA)]\n","      - [cov:legalName, $(nome_ente)]\n","      - [clv:hasSpatialCoverage, https://esame.MITD.it/data/City/$(codice_ISTAT_comune)~iri]\n","      - [prj:isInvolvedInProject, https://esame.MITD.it/data/PublicInvestmentProject/$(codice_finanziamento)~iri]\n","\n","  City:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/City/$(codice_ISTAT_comune)\n","    po:\n","      - [a, clv:City]\n","      - [l0:name, $(comune)]\n","      - [l0:identifier, $(codice_ISTAT_comune)]\n","\n","  PublicInvestmentProject:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/PublicInvestmentProject/$(codice_finanziamento)\n","    po:\n","      - [a, prj:PublicInvestmentProject]\n","      - [prj:projectTotalCost, $(importo_finanziamento)]\n","      - [prj:hasCall, https://esame.MITD.it/data/Call/$(codice_avviso_PNRR)~iri]\n","\n","  Call:\n","    sources:\n","      - [Prog_2.csv~csv]\n","    s: https://esame.MITD.it/data/Call/$(codice_avviso_PNRR)\n","    po:\n","      - [a, prj:Call]\n","      - [l0:name, $(avviso_PNRR)]\n","\n"]}]},{"cell_type":"code","source":["from rdflib import Graph\n","\n","# Carica il file RDF in formato Turtle\n","g = Graph()\n","try:\n","    g.parse(\"/content/ontology.ttl\", format=\"turtle\")\n","    print(\"File RDF caricato correttamente.\")\n","except Exception as e:\n","    print(f\"Errore nel caricamento del file RDF: {e}\")\n","\n","# Stampa il numero di triplette nel grafo per verificare il caricamento\n","print(f\"Il grafo contiene {len(g)} triplette.\")\n","\n","# Stampa alcune triplette come esempio\n","for i, tripletta in enumerate(g):\n","    print(tripletta)\n","    if i == 9:  # Stampa solo le prime 10 triplette per evitare troppi output\n","        break\n","\n","# Query SPARQL per estrarre la metadatazione secondo il modello DCAT-AP_IT\n","query = \"\"\"\n","PREFIX dcat: <http://www.w3.org/ns/dcat#>\n","PREFIX dct: <http://purl.org/dc/terms/>\n","PREFIX foaf: <http://xmlns.com/foaf/0.1/>\n","\n","SELECT ?dataset ?title ?description ?issued ?modified ?publisherName\n","WHERE {\n","  ?dataset a dcat:Dataset ;\n","           dct:title ?title ;\n","           dct:description ?description ;\n","           dct:issued ?issued ;\n","           dct:modified ?modified ;\n","           dct:publisher ?publisher .\n","  ?publisher foaf:name ?publisherName .\n","}\n","\"\"\"\n","\n","# Esegui la query e stampa i risultati\n","try:\n","    results = g.query(query)\n","    print(\"Query eseguita correttamente.\")\n","except Exception as e:\n","    print(f\"Errore nell'esecuzione della query: {e}\")\n","\n","if results:\n","    for row in results:\n","        print(f\"Dataset: {row.dataset}\")\n","        print(f\"Title: {row.title}\")\n","        print(f\"Description: {row.description}\")\n","        print(f\"Issued: {row.issued}\")\n","        print(f\"Modified: {row.modified}\")\n","        print(f\"Publisher: {row.publisherName}\")\n","        print(\"-\" * 40)\n","else:\n","    print(\"Nessun risultato trovato.\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lokdAr8cZ5_a","executionInfo":{"status":"ok","timestamp":1719151468814,"user_tz":-120,"elapsed":445,"user":{"displayName":"Tania Brusadin","userId":"18197826850071657743"}},"outputId":"f6c45f3a-5946-49a2-deb8-134214a34753"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["File RDF caricato correttamente.\n","Il grafo contiene 105 triplette.\n","(rdflib.term.URIRef('https://esame.MITD.it/data/PublicInvestmentProject/4444'), rdflib.term.URIRef('https://w3id.org/italia/onto/PRJ/projectTotalCost'), rdflib.term.Literal('14000.0', datatype=rdflib.term.URIRef('http://www.w3.org/2001/XMLSchema#float')))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/PublicOrganization/c_l474'), rdflib.term.URIRef('https://w3id.org/italia/onto/PRJ/isInvolvedInProject'), rdflib.term.URIRef('https://esame.MITD.it/data/PublicInvestmentProject/5555'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/Call/1.4.3'), rdflib.term.URIRef('http://www.w3.org/1999/02/22-rdf-syntax-ns#type'), rdflib.term.URIRef('https://w3id.org/italia/onto/PRJ/Call'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/PublicOrganization/c_d903'), rdflib.term.URIRef('https://w3id.org/italia/onto/COV/IPACode'), rdflib.term.Literal('c_d903'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/PublicOrganization/c_c167'), rdflib.term.URIRef('http://www.w3.org/1999/02/22-rdf-syntax-ns#type'), rdflib.term.URIRef('https://w3id.org/italia/onto/COV/PublicOrganization'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/City/004050'), rdflib.term.URIRef('https://w3id.org/italia/onto/l0/identifier'), rdflib.term.Literal('004050'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/Call/1.4.1'), rdflib.term.URIRef('https://w3id.org/italia/onto/l0/name'), rdflib.term.Literal('1.4.1_Esperienza_del_Cittadino_Comuni_settembre_2022'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/PublicOrganization/c_l474'), rdflib.term.URIRef('http://www.w3.org/1999/02/22-rdf-syntax-ns#type'), rdflib.term.URIRef('https://w3id.org/italia/onto/COV/PublicOrganization'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/City/004050'), rdflib.term.URIRef('http://www.w3.org/1999/02/22-rdf-syntax-ns#type'), rdflib.term.URIRef('https://w3id.org/italia/onto/CLV/City'))\n","(rdflib.term.URIRef('https://esame.MITD.it/data/PublicInvestmentProject/9999'), rdflib.term.URIRef('https://w3id.org/italia/onto/PRJ/projectTotalCost'), rdflib.term.Literal('79922.0', datatype=rdflib.term.URIRef('http://www.w3.org/2001/XMLSchema#float')))\n","Query eseguita correttamente.\n","Nessun risultato trovato.\n"]}]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}